<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [

<!ENTITY RFC7908 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.7908.xml">
<!ENTITY RFC8092 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8092.xml">
<!ENTITY RFC8205 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.8205.xml">
<!ENTITY I-D.ietf-idr-bgp-open-policy SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-idr-bgp-open-policy.xml">
<!--
<!ENTITY I-D.ietf-idr-aspath-orf SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-idr-aspath-orf.xml">

<!ENTITY I-D.ietf-idr-route-leak-detection-mitigation SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.ietf-idr-route-leak-detection-mitigation.xml">

<!ENTITY I-D.draft-sriram-idr-route-leak-solution-discussion SYSTEM "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-sriram-idr-route-leak-solution-discussion.xml">
-->
]>


<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" docName="draft-ietf-idr-route-leak-detection-mitigation-11" ipr="trust200902">
  <front>
    <title abbrev="Route Leak Detection and Mitigation"> Methods for Detection and Mitigation of BGP Route Leaks </title>

    <author fullname="Kotikalapudi Sriram" initials="K." role="editor" surname="Sriram">
      <organization abbrev="USA NIST">USA National Institute of Standards and Technology</organization>
      <address>
         <postal>
          <street>100 Bureau Drive</street>
          <city>Gaithersburg</city>
          <region>MD</region>
          <code>20899</code>
          <country>United States of America</country>
        </postal>
        <email>ksriram@nist.gov</email>
      </address>
    </author>

    <author fullname="Alexander Azimov" initials="A." role="editor" surname="Azimov">
      <organization abbrev="Yandex">Yandex</organization>
      <address>
         <postal>
          <street></street>
          <city>Moscow</city>
          <region></region>
          <code></code>
          <country>Russia</country>
        </postal>
        <email>a.e.azimov@gmail.com</email>
      </address>
    </author>

    <date year="2019" />

    <area>Routing</area>

    <workgroup>IDR and SIDR</workgroup>

    <keyword>BGP, Route Leak Detection, Route-Leak Mitigation, BGP Security</keyword>

    <abstract>
      <t>
        Problem definition for route leaks and enumeration of types of route leaks are provided in RFC 7908.
        This document describes a inter-AS (multi-hop) solution for detection and mitigation route leaks which is based on conveying route-leak detection information in two new well-known BGP communities: route leak detection community (RLD) and route leak notification community (RLN).
        These communities gives ISPs an easy way to detect route leaks, and, if needed, propagate information about such incidents.
        This solution complements the intra-AS (local AS) route-leak avoidance solution that is described in ietf-idr-bgp-open-policy draft.
      </t>
    </abstract>

  </front>

  <middle>
    <section title="Introduction">
      <t>
        RFC 7908 <xref target="RFC7908"></xref> provides a definition of the route leak problem, and enumerates several types of route leaks.
        For this document, the definition that is applied is that a route leak occurs when a route received from a transit provider or a lateral peer is forwarded (against commonly used policy) to another transit provider or a lateral peer.
        The commonly used policy is that a route received from a transit provider or a lateral peer may be forwarded only to customers.
      </t>
      <t>
        This document describes a solution for detection and mitigation route leaks which is based on conveying route-leak information in a Border Gateway Protocol (BGP) community.
        These document specified two well-known communities for these purpose - route leak detection (RLP) and route leak notification (RLN) community.
        Its configuration policies MUST be defined according to peering relations between ISPs.
        If BGP Roles described in <xref target="I-D.ietf-idr-bgp-open-policy"></xref> are configured, community configuration SHOULD be implemented in code of routing software.
      </t>
      <t>
        Described technique can be incrementally deployed.
        If a group of big ISPs or/and IXes deploy proposed route marking, then they would be helping each other by blocking route leaks that can happen between them.
      </t>
    </section>

    <section anchor="relations" title="Peering Relationships">
      <t>
        As described in <xref target="I-D.ietf-idr-bgp-open-policy"></xref> there are several common peering relations between eBGP sessions:
        <list style="symbols">
          <t>Provider - sender is a transit provider to neighbor;</t>
          <t>Customer - sender is customer of neighbor;</t>
          <t>RS - sender is route server at internet exchange point (IX)</t>
          <t>RS-client - sender is client of RS at internet exchange point (IX)</t>
          <t>Peer - sender and neighbor are peers;</t>
        </list>
      </t>
      <t>
        If the route is announced to a customer or RS-client it MUST go 'only down' and should not be received by other ISPs from links with customers, peers or at IX route servers from RS-clients.
        The described below community provide an easy way to maintain this rule.
      </t>
    </section>

    <section anchor="detection" title="Route-Leak Detection Community">
      <t>
        The RLD community MUST follow next semantics:
        <list style="numbers">
          <t>4200000000 - suggested class for well-known large communities;</t>
          <t>2 - RLD subclass;</t>
          <t>value - ASN who set the community</t>
        </list>
        This community MUST be set if route is announced to Customer, RS-client or Peer with a proper ASN value.
      </t>
      <t>
        The are three rules that enables detection route leaks:
        <list style="symbols">
          <t>If route with RLD set received from Customer or RS-client - it's a route leak</t>
          <t>If route with RLD set received from Peer and RLD Values isn't equal to neighbor ASN - it's route leak</t>
          <t>If route with RLN set received from any eBGP session (see bellow) - it's a route leak</t>
        </list>
        This two rules provide an easy way to detect policy violation at the per-prefix granularity.
      </t>
    </section>

    <section anchor="notification" title="Route-Leak Notification Community">
      <t>
        In the previous section was described as a method to detect route leaks.
        In this section will be discussed different options what ISP SHOULD do if route leak is detected.
        The straightforward way is to reject leaked routes.
        But such filtering strategy might have side-effects.
      </t>

      <t>
        If prefix has a single path to Tier1 providers its whole connectivity depends on this path existence.
        And if this path is leaked, and rejected afterwards by transit ISP, including Tier1, it will make this prefix partially unavailable.
        So, in this case victim may experience DoS because of mistake of third party.
        We found that more then 100k prefixes (about 15% of all prefixes in the today full view table) have single path and thus can be affected.
        The deprioritization is a soft way to stop route leak propagation that solves the problem of possible outages.
      </t>

      <t>
        But propagation of leaked should be also done with caution.
        When the prefix is received from provider RLD community can't be used to tell if the route was leaked or not.
        And if it was leaked it may result in BGP wedges scenario or even create a stable oscillation with dynamic BGP loops.
      </t>

      <t>
        To address this issue we introduce another well-known BGP community Route Leak Notification (RLN).
        It has next semantics:
        <list style="numbers">
          <t>4200000000 - suggested class for well-known large communities;</t>
          <t>2 - RLN subclass;</t>
          <t>value - ASN who set the community</t>
        </list>
      </t>

      <t>
        To avoid possible stable oscillations each leaked prefix MUST be marked with RLN community.
        If prefix is marked with RLN community - it MUST be treated as route leak.
        This rule complements detection measures via RLD community described in previous session.
      </t>

    </section>

    <section anchor="mitigation" title="Route-Leak Notification Mitigation">
      <t>
        In previous were described ways to detect route leaks using RLD and RLN communities.
        In this section will be presented suggested method for route leak mitigation.
      </t>

      <t>
        <list style="symbols">
          <t>If leaked prefix is learned from RS-client it MUST be rejected</t>
          <t>If leaked prefix is learned from Peer, Provider or RS and network has default route it MUST be rejected</t>
          <t>Otherwise leaked prefix MUST be deprioritized</t>
        </list>
        The deprioritization MUST be made using local preference attribute, the suggested value is 0.
      </t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>
        With the use of BGP community, there is often a concern that the community propagates beyond its intended perimeter and causes harm <xref target="streibelt"></xref>.
        However, that concern does not apply to the RLD and RLN communities because it is a transitive community that must propagate as far as the update goes.
      </t>
      <t>
        The proposed ruote leak information carried in the RLD and RLN communities can benefit from cryptographic protection to prevent abuse by malicious actors in the AS path.
        In the future, if there is BGPsec deployment, the RLP and RLN information can be encoded in the Flags field in the Secure_Path Segment in BGPsec updates <xref target="RFC8205"></xref>.
        So, the cryptographic security mechanisms in BGPsec can also secure the route leak detection information.
        The reader is directed to the security considerations provided in <xref target="RFC8205"></xref>.
      </t>

    </section>


    <section anchor="IANA" title="IANA Considerations">
      <t>
        The draft suggests to reserve Global Administrator ID 4200000000 for well-known large community registry.
        IANA is requested to register RLN and RLD in the well-known large community <xref target="RFC8092"></xref> registry.
      </t>
    </section>
  </middle>

  <back>


    <references title="Informative References">
      &RFC7908;
      &RFC8092;
      &RFC8205;

      &I-D.ietf-idr-bgp-open-policy;

      <reference anchor="streibelt" target="https://archive.psg.com//181101.imc-communities.pdf">
        <front>
          <title>BGP Communities: Even more Worms in the Routing Can</title>

        <author initials="F." surname="Streibelt et al.">
        <organization></organization>
        </author>

        <date month='October' year='2018' />
        </front>
        <seriesInfo name='' value='ACM IMC' />
      </reference>
    </references>
  </back>
</rfc>